# 🔗 راهنمای ارتباط پلی‌لیست به چنل

این قابلیت به شما اجازه می‌دهد که هر پلی‌لیست اسپاتیفای را به یک چنل تلگرام مخصوص متصل کنید.

## 🎯 کاربردها

- **چند چنل موضوعی**: هر چنل برای یک ژانر خاص
  - چنل راک → پلی‌لیست راک
  - چنل پاپ → پلی‌لیست پاپ
  - چنل کلاسیک → پلی‌لیست کلاسیک

- **چنل‌های مختلف برای مخاطبان مختلف**: 
  - چنل عمومی → پلی‌لیست‌های پرطرفدار
  - چنل VIP → پلی‌لیست‌های اختصاصی

- **سازماندهی بهتر**: هر پلی‌لیست به چنل مربوط به خودش می‌رود

## 📋 دستورات جدید

### 1. `/linkplaylist` - ارتباط پلی‌لیست به چنل

این دستور برای تغییر یا تنظیم چنل یک پلی‌لیست موجود استفاده می‌شود.

**مراحل استفاده:**

1. دستور `/linkplaylist` را ارسال کنید
2. از لیست دکمه‌های نمایش داده شده، پلی‌لیست مورد نظر را انتخاب کنید
3. ID یا username چنل جدید را ارسال کنید

**مثال:**

```
شما: /linkplaylist

ربات: 
🔗 ارتباط پلی‌لیست به چنل

لطفا پلی‌لیستی که می‌خواهید به چنل جدید مرتبط کنید را انتخاب کنید:
[دکمه] 🎵 پلی‌لیست راک (چنل: @rockchannel)
[دکمه] 🎵 پلی‌لیست پاپ (چنل: @popchannel)
[دکمه] ❌ انصراف

[شما یکی از دکمه‌ها را میزنید]

ربات:
🎵 پلی‌لیست انتخاب شده: پلی‌لیست راک
📺 چنل فعلی: @rockchannel

لطفا ID چنل جدید را ارسال کنید:
مثال: @channelname یا -1001234567890

شما: @newrockchannel

ربات:
✅ چنل برای پلی‌لیست 'پلی‌لیست راک' به @newrockchannel تغییر یافت!

حالا آهنگ‌های جدید این پلی‌لیست به این چنل ارسال می‌شوند.
```

### 2. `/showlinks` - نمایش ارتباطات

این دستور لیست تمام پلی‌لیست‌ها و چنل‌های مرتبط با آن‌ها را نمایش می‌دهد.

**خروجی نمونه:**

```
🔗 ارتباط پلی‌لیست‌ها با چنل‌ها:

1. 🎵 پلی‌لیست راک
   📺 چنل: @rockchannel
   📊 تعداد آهنگ: 250
   🕐 آخرین چک: 2025-10-14 15:30
   🔗 [لینک پلی‌لیست](https://open.spotify.com/playlist/...)

2. 🎵 پلی‌لیست پاپ
   📺 چنل: @popchannel
   📊 تعداد آهنگ: 180
   🕐 آخرین چک: 2025-10-14 15:32
   🔗 [لینک پلی‌لیست](https://open.spotify.com/playlist/...)

3. 🎵 پلی‌لیست کلاسیک
   📺 چنل: ❌ تنظیم نشده
   📊 تعداد آهنگ: 95
   🕐 آخرین چک: هرگز
   🔗 [لینک پلی‌لیست](https://open.spotify.com/playlist/...)

[دکمه] 🔗 تغییر ارتباط
[دکمه] 🔙 بازگشت
```

### 3. `/addplaylist` - افزودن با تنظیم چنل

هنگام افزودن پلی‌لیست جدید، حالا می‌توانید مستقیماً چنل را تنظیم کنید.

**مراحل:**

1. `/addplaylist` را ارسال کنید
2. لینک پلی‌لیست را ارسال کنید
3. نام دلخواه برای پلی‌لیست را وارد کنید
4. **ID چنل مورد نظر را ارسال کنید** (قابلیت جدید!)

**مثال:**

```
شما: /addplaylist

ربات: لطفا لینک پلی‌لیست اسپاتیفای را ارسال کنید

شما: https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M

ربات: ✅ لینک دریافت شد.
حالا یک نام برای این پلی‌لیست وارد کنید:

شما: پلی‌لیست الکترونیک

ربات: ✅ لینک و نام دریافت شد.
حالا ID چنل مورد نظر را ارسال کنید:
مثال: @channelname یا -1001234567890

شما: @electronicchannel

ربات: ✅ پلی‌لیست 'پلی‌لیست الکترونیک' با موفقیت اضافه شد!
چنل تنظیم شده: @electronicchannel

می‌خواهید الان آهنگ‌های آن را چک و ارسال کنید؟
[دکمه] 📤 ارسال فوری آهنگ‌های این پلی‌لیست
```

## 🎮 نکات مهم

### فرمت ID چنل

دو فرمت قابل قبول هستند:

1. **Username چنل** (اگر چنل عمومی است):
   ```
   @mymusicchannel
   ```
   یا فقط:
   ```
   mymusicchannel
   ```

2. **ID عددی چنل** (برای چنل‌های خصوصی):
   ```
   -1001234567890
   ```

### چگونه ID چنل را پیدا کنیم؟

#### روش 1: استفاده از ربات‌های شناسایی ID

1. ربات [@userinfobot](https://t.me/userinfobot) را به چنل خود اضافه کنید
2. یک پیام در چنل forward کنید به این ربات
3. ربات ID چنل را نمایش می‌دهد

#### روش 2: استفاده از Web Telegram

1. به https://web.telegram.org بروید
2. چنل خود را باز کنید
3. از URL چنل، عدد بعد از `s` را بردارید و `-100` را به ابتدای آن اضافه کنید
   - مثال: اگر URL این است: `https://web.telegram.org/#/im?p=s1234567890`
   - ID شما می‌شود: `-1001234567890`

### دسترسی‌های لازم

⚠️ **مهم**: ربات باید در چنل مورد نظر **Admin** باشد و دسترسی‌های زیر را داشته باشد:
- Post Messages
- Edit Messages
- Delete Messages

## 🔄 تغییر چنل یک پلی‌لیست

می‌توانید هر زمان که بخواهید چنل یک پلی‌لیست را تغییر دهید:

1. `/linkplaylist` را ارسال کنید
2. پلی‌لیست مورد نظر را انتخاب کنید
3. چنل جدید را وارد کنید
4. تمام آهنگ‌های **جدید** بعد از این به چنل جدید می‌روند

⚠️ **توجه**: آهنگ‌هایی که قبلاً ارسال شده‌اند، در چنل قدیم باقی می‌مانند.

## 💡 سناریوهای کاربردی

### سناریو 1: چند چنل موضوعی

```
پلی‌لیست‌ها:
- Rock Hits 2025 → @rockhits2025
- Pop Charts → @popcharts2025
- Classical Music → @classicalbeats
- Jazz Collection → @jazzlovers
```

### سناریو 2: چنل‌های زبان‌های مختلف

```
پلی‌لیست‌ها:
- English Songs → @englishmusic
- Persian Songs → @persianmusic
- Turkish Songs → @turkishmusic
```

### سناریو 3: سطح‌بندی کاربران

```
پلی‌لیست‌ها:
- Free Playlist → @freemusicchannel (عمومی)
- Premium Playlist → @premiummusicchannel (خصوصی)
- VIP Exclusive → @vipmusicchannel (خصوصی)
```

## 📊 مثال عملی کامل

فرض کنید می‌خواهید 3 پلی‌لیست را به 3 چنل مختلف متصل کنید:

```bash
# مرحله 1: افزودن پلی‌لیست اول
/addplaylist
# لینک: https://open.spotify.com/playlist/rock123
# نام: Rock Legends
# چنل: @rocklegends

# مرحله 2: افزودن پلی‌لیست دوم
/addplaylist
# لینک: https://open.spotify.com/playlist/pop456
# نام: Pop Hits
# چنل: @pophits

# مرحله 3: افزودن پلی‌لیست سوم
/addplaylist
# لینک: https://open.spotify.com/playlist/jazz789
# نام: Jazz Classics
# چنل: @jazzclassics

# بررسی ارتباطات
/showlinks

# خروجی:
# 1. 🎵 Rock Legends → 📺 @rocklegends
# 2. 🎵 Pop Hits → 📺 @pophits
# 3. 🎵 Jazz Classics → 📺 @jazzclassics

# اگر بخواهید چنل Rock Legends را عوض کنید:
/linkplaylist
# انتخاب: Rock Legends
# چنل جدید: @newrocklegends

# تایید:
# ✅ چنل برای پلی‌لیست 'Rock Legends' به @newrocklegends تغییر یافت!
```

## 🐛 عیب‌یابی

### مشکل: "ربات نمی‌تواند به چنل ارسال کند"

**راه حل:**
1. مطمئن شوید ربات در چنل Admin است
2. دسترسی "Post Messages" را بررسی کنید
3. اگر چنل خصوصی است، از ID عددی استفاده کنید نه username

### مشکل: "ID چنل نامعتبر است"

**راه حل:**
1. مطمئن شوید فرمت صحیح است (@channel یا -100...)
2. اگر از username استفاده می‌کنید، چنل باید عمومی باشد
3. ID عددی را دوباره از ربات شناسایی ID بگیرید

### مشکل: "آهنگ‌ها به چنل اشتباه می‌رود"

**راه حل:**
1. `/showlinks` را اجرا کنید و ارتباطات را بررسی کنید
2. از `/linkplaylist` برای تصحیح چنل استفاده کنید
3. ربات را restart کنید: `docker-compose restart`

## 🎯 نکات پیشرفته

### استفاده از config.json

تمام تنظیمات در فایل `config.json` ذخیره می‌شود:

```json
{
  "playlists": [
    {
      "url": "https://open.spotify.com/playlist/...",
      "name": "Rock Legends",
      "channel_id": "@rocklegends",
      "added_by": 123456789,
      "added_at": "2025-10-14T15:30:00",
      "last_check": "2025-10-14T16:00:00",
      "track_count": 250
    }
  ]
}
```

می‌توانید این فایل را دستی ویرایش کنید (اگر لازم باشد).

### Backup کردن تنظیمات

```bash
# Backup کردن config
cp config.json config.json.backup

# Restore کردن
cp config.json.backup config.json
docker-compose restart
```

## 📞 پشتیبانی

اگر مشکلی داشتید:

1. لاگ‌های ربات را بررسی کنید:
   ```bash
   docker-compose logs -f
   ```

2. مطمئن شوید ربات در تمام چنل‌ها Admin است

3. config.json را بررسی کنید

4. Issue در GitHub ایجاد کنید با جزئیات مشکل

---

**تاریخ ایجاد**: اکتبر 2025  
**نسخه**: 2.0  
**قابلیت جدید**: Multi-Channel Playlist Mapping
